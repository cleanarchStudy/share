# 14장. 컴포넌트 결합

## 서론





## ADP: 의존성 비순환 원칙

컴포넌트 의존성 그래프에 순환이 있어서는 안된다.



### 의존성이 순환할때의 문제점

'숙취증후군' : 동일한 소스 파일을 수정하는 과정에서 의존하고있던 무언가를 누군가 수행했을때 작동되지 않는 문제

### 해결책

#### 주단위 빌드:

​	대부분 각자 개발하고 빌드시점에 통합과정을 거침 -> 거대해질수록 통합과정이 길어지는 문제 발생

-> 통합, 테스트수행이 어려워짐에 따라 빠른피드백을 주지 못하게됨(변화에 취약)



#### 순환의존성 제거:

1. 개발환경을 릴리즈 가능한 컴포넌트 단위로 분리



??: 컴포넌트가 독립적인 릴리즈가 가능한 단위라고 했을때, 패키지단위를 독립적인 릴리즈가 가능한 형태로 만들지는 않지 않나?

120p의 예시 



#### 순환이 컴포넌트 의존성 그래프에 미치는 영향

순환되는 컴포넌트들은 서로 동기화된 릴리즈를 모두 사용해야함. 

-> 거대한 컴포넌트가 되어버림



1. 거대한 컴포넌트 -> 의존성이 많아서 테스트하기가 복잡해짐, 에러가 발생함. 

2. 어떤 순서로 빌드해야할지 파악하기 어려워짐. 시작지점이 어딘데? 알수없음. 



### 순환 끊기

1. DIP로 고수준 컴포넌트 내부에 인터페이스 두기
2. 인터페이스 부분을 컴포넌트화 하기



### 흐트러짐

요구사항의 변경에 따라 컴포넌트의 구조가 바뀌므로 항상 의존성 순환여부를 관찰해야함. 



### 하향식 설계





## SDP: 안정된 의존성 원칙



의존성이 적고 외부에서 참조하는 경우 -> 독립적이다. 책임진다.



### 안정성지표 

불안정성 I = Fan-out / (Fan-in+ Fan-out)



### 모든 컴포넌트가 안정적이어야만 하는것은 아님



관례: 불안정한 컴포넌트를 위에 둠 



### 추상 컴포넌트

실행 가능한 코드가 전혀 없어도 잘 사용되는 개념

ex. 헥사고널 아키텍처의 port 부분이 일종에 컴포넌트로 변화된 형태인듯?



## SAP: 안정된 추상화 원칙

컴포넌트는 안정된 정도만큼만 추상화되어야 한다.



추상화정도 A = 추상클래스 or 인터페이스 개수 / 컴포넌트의 클래스 개수



### 고통의 구역

안정적이지만 구체적인

ex. 

1. db 스키마
2. String 안정적인 라이브러리



### 쓸모없는 구역

너무 추상적(A는 1)인데 의존하고있지도 않음

-----



### ADP

presentation





server 를 사용해서 순환끊어짐

inventory -> server <- order



Oder inventory간의 순환참조 

server가 중간다리가 되는 것. 





### SDP

안정성의 방향으로 의존하라

공식버전사용 -> 안정된 컴포넌트 



String 



### SAP

코드를 어떻게 만들어야하는데 

생각보다 우리가 하고있던것





-----

결론

시안님: 모든 가능성을 열어두기 위한 빌드업으로 원칙을 설명한듯. 



인터페이스 만들었는데 아무도 안쓰면 쓸모없는것

